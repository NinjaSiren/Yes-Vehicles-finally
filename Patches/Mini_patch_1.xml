<?xml version="1.0" encoding="utf-8" ?>
<Patch>

    <!-- Adds all weapons with additional quality and skill needs value value -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="Rail_Cannon" or defName="Tank_Cannon" or defName="Burst_Cannon" or defName="Machine_Cannon" or defName="Machine_Gun"]/recipeMaker</xpath>
		<value>
            <workSpeedStat>SmithingSpeed</workSpeedStat>
            <workSkill>Crafting</workSkill>
            <effectWorking>Smith</effectWorking>
            <soundWorking>Recipe_Smith</soundWorking>
		</value>
	</Operation>

	<!-- Adds all weapons with the weaponTags Gun value -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="Rail_Cannon" or defName="Tank_Cannon" or defName="Burst_Cannon" or defName="Machine_Cannon" or defName="Machine_Gun"]/weaponTags</xpath>
		<value>
	        <li>Gun</li>
		</value>
	</Operation>	

	<!-- Adds all weapons with the weaponTags Gun value -->
	<Operation Class="PatchOperationAdd">
	    <xpath>Defs/ThingDef[defName="Tank" or defName="APC" or defName="ATV" or defName="Truck"]/comps/li[@Class="CompProperties_Refuelable"]</xpath>
		<value>
            <fuelLabel>Fuel gauge</fuelLabel>
            <fuelGizmoLabel>Fuel level</fuelGizmoLabel>		
            <initialFuelPercent>1.0</initialFuelPercent>
            <autoRefuelPercent>0.0</autoRefuelPercent>
            <showFuelGizmo>true</showFuelGizmo>
            <fuelMultiplier>1.0</fuelMultiplier>
            <outOfFuelMessage>Vehicle has an empty fuel tank, please refill</outOfFuelMessage>
            <fuelIconPath>UI/Overlays/Barrel</fuelIconPath>
		</value>
	</Operation>	
	
	<!-- Fixes the weapon quality JobDriver error -->
	<Operation Class="PatchOperationFindMod">
        <mods>
            <li>[O21] Vehicle Framework</li>
        </mods>
		
        <match Class="PatchOperationSequence">
            <success>Always</success>
            <operations>
			    
				<li Class="PatchOperationReplace">
				    <xpath>Defs/ThingDef[@Name="O21Vehicle_GunBase"]/comps</xpath>
					    <value>
						    <comps>
								<li>
				        	        <compClass>CompQuality</compClass>
			            	    </li>
			            	    <li Class="CompProperties_Art">
				        	        <nameMaker>NamerArtWeaponGun</nameMaker>
				        	        <descriptionMaker>ArtDescription_WeaponGun</descriptionMaker>
				        	        <minQualityForArtistic>Excellent</minQualityForArtistic>
			            	    </li>
							</comps>
						</value>
				</li>
			</operations>
	    </match>
	</Operation>
</Patch>